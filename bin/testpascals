#!/bin/bash
#
# Script to test pascals
#
# Compile pascals
#
compile $1 sample_programs/pascals
#
# Run that with the input file appended to the intermediate/object
#
run $1 sample_programs/pascals.inp sample_programs/pascals
if [ $? -eq 0 ]; then

    #
    # Compare to reference
    #
    strip sample_programs/pascals.lst tmp1
    strip sample_programs/pascals.cmp tmp2
    diff -B tmp1 tmp2 > sample_programs/pascals.dif
    rm -f tmp1
    rm -f tmp2
    ls -l sample_programs/pascals.dif > tmp1
    grep ".dif" tmp1
    rm -f tmp1
    ## pass if diff file is empty
    if test -s sample_programs/pascals.dif
    then
        if [ "$noerrmsg" = "0" ]; then
    		    
            echo "*** FAIL"

        fi
        exit 1
    else
        echo "PASS"
    fi

else

    exit 1

fi