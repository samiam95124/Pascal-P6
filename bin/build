#!/bin/bash
#
# General build script for Pascal-P6
#
# Form:
# 
# build [<options for make>] [<options for pc>]
#
# Note: if you want to give multiple options for make or pc, surround in quotes
# like:
#
# build "-Bi" "-r -d"
#
function compprog {

   pc $1 $OPTIONS
   if [ $? -ne 0 ]; then

      echo "*** Error: compile failed"
      exit 1

   fi
   cp $1 bin

}

OPTIONS=$2

make clean
make $1
if [ $? -ne 0 ]; then

   echo "*** Error: make failed"
   exit 1

fi
compprog pc/pc
compprog pc/hashtabr
compprog pc/hashtabs
compprog source/genobj
compprog libs/source/strtst
compprog source/pcom
compprog source/pint
compprog source/pmach
compprog source/AMD64/gcc/pgen
